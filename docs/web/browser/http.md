# HTTP进化史

当我们谈及一个事物的进化的时候，它一定因为存在一定的契机或者说问题，然后有了更好的解决方案，才会进行进化的。在HTTP的整个发展过程中呢，也是如此。

HTTP全称 **超文本传输协议**，其最初发明的目的是为了传输 HTML 文件用的，当然从现在看来它能传输的东西不只是HTML。关于这个协议一个标准点的说法是: <u>HTTP是一个客户端（用户）和服务端（网站）之间请求和应答的标准</u>。也即由客户端发起请求给到服务端，服务端处理之后给出应答数据。


## HTTP/0.9
0.9的协议早已过时，是最早期的一个协议版本。其请求报文只有一个请求行，没有请求头和请求体，也就不能给服务器传递数据和附加信息。服务端返回的内容也只是相应的主体内容，没有返回头信息。这其实就是最早期的 HTTP 发明的目的和用处了，就是用来传输一下 HTML文件，也并不需要其他额外的东西，刚好满足需求。

问题来了：
- 客户端想要返回的页面是中文的而不是默认的英文的内容怎么办？
- 客户端的数据编码格式用的是GB2312不是UTF-8咋办？
- 我们不只是想用HTTP来传输HTML，还有了PDF、图片文件咋办？

上面问题总结起来就是：服务端想知道客户端的信息咋办？

## HTTP/1.0
HTTP/1.0的版本中增加了请求头和请求体信息，有了请求头，服务端就能知道客户端当前的状态，比如可以支持什么样的文件压缩方式，支持什么语言，支持什么数据编码格式等等。

服务端也有了响应头信息，这样也能给客户端数据的同时告诉客户端，当前的文件是个PDF还是个正常HTML文件，客户端拿到这个信息才能知道我该如何处理这个文件，如果给到的文件类型信息是错的，那解析的东西就是一堆乱码了。

HTTP/1.0 用请求头、响应头作为附加信息，让客户端和服务端都能给到更多具体的数据传输所需要的描述信息。它已经能够满足大部分的需求，但是还是存在一些小问题，然而这些问题，在有了HTTP/1.0 的基础之后，也在它的增强版本 HTTP/1.1 中得到修补。


## HTTP/1.1 
1.1的版本在1.0的版本上做了一些修补，主要提供了如下的功能特性：
- 改进了持久连接
- 不成熟的管线化技术（已经放弃）
- 提供虚拟主机的支持（HOST）
- 对服务端动态生成内容的完美支持（Content-Length）
- 客户端Cookie、安全机制

之前的HTTP请求都是建立一个TCP链接就执行一次HTTP请求流程，然后就断开连接了，新增的持久链接，让客户端与服务端能保持一个TCP链接，在其中执行多个HTTP请求流程，这样就大大减少了重复建立TCP连接和断开连接的成本（TCP三次握手建立连接和四次挥手断开连接）

虽然能持久化连接了，但是HTTP请求的发送是一个请求发送并接收完，然后再发送下一个，依次执行下去。这样就会造成HTTP队头阻塞的问题，也就是说，当第一个HTTP请求如果延时了，那么后续的请求也都跟着排队延时。那能不能并行发送呢？于是有了管线化的设想，就是客户端可以同时将多个请求一股脑直接发送给服务器，然后等待服务器返回就行了。不过可惜的是，这项技术在做了一些试验之后最终没搞成，放弃了。

另外在HTTP1.1中，通过请求头信息也能给到服务器告诉其请求的Host是哪个，实现了同一台服务器可以绑定多个Host，然后根据用户端给到的Host信息，把请求送到对应的虚拟主机当中。

同样也是因为Header头信息，服务端可以在响应头中通过 Content-Length 告诉客户端返回的响应内容的大小，这让服务端可以进行动态的内容生成。

总的来说，有了Header头信息之后，HTTP/1.1 做了一系列优化，使HTTP协议更加完善了。目前咱们使用 HTTP协议版本还是 1.1 的居多。

那是不是就完美了呢？当然不是，还是存在一些问题的：
- 慢启动
- 带宽竞争
- HTTP队头阻塞


### 慢启动


### 贷款竞争

### HTTP队头阻塞

## HTTP/2

核心特性：多路复用

多路复用就是指，对同一个域名，我们只建立一个TCP连接，通过二进制分帧层，我们可以同时发送多个请求，不会存在HTTP队头阻塞的问题；同时因为只建立了一个TCP连接，只会有一次慢启动的过程，也算是不错的的改进；HTTP2还能设置资源优先级，这样在发送和处理请求的时候，可以选择更高优的先行处理，也就避免了关键资源和非关键资源的带宽竞争问题


解决方案：增加二进制分帧层
HTTP2 的特性：
1. 多路复用
2. 设置资源优先级
3. 服务端推送 (Server Push)
4. 头部压缩 (header)

问题：
- TCP队头阻塞
- TCP建立连接延时
- TCP协议僵化（中间设备僵化，无法升级调整）

## HTTP/3
解决办法：QUIC协议